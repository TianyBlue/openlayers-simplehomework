import{T as m,X as d,V as M,s as w,M as N,a as V,c as x,F as T,O,b as v,G as g,d as h,S as p,C as X,e as b,f as q,D as z,$ as i}from"./vendor.f8db6fcc.js";const D=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&n(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}};D();new m({title:"\u5929\u5730\u56FE\u77E2\u91CF",source:new d({url:"http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",wrapX:!1})});var R=new M({center:[115,35],zoom:6,projection:"EPSG:4326"});new w({units:"metric",bar:!0,text:!0,className:"ol-scale-line"});var l=new N({target:"map",layers:[],view:R}),j=new w({units:"metric",target:"scalebar",className:"ol-scale-line"}),A=new V({className:"mosuePosition",coordinateFormat:x(6),projection:"EPSG:4326",target:document.getElementById("position")}),I=new T,W=function(){l.addControl(j)},_=function(){l.addControl(I)},B=function(){l.addControl(A)},u=[],S=[],F=[],H=".layers";function J(e,t){e.addEventListener("click",function(){this.checked?t.setVisible(!0):t.setVisible(!1)})}var Y=function(){for(var e=l.getLayers(),t=document.querySelector(H),r=0;r<e.getArray().length;r++){u[r]=e.item(r),S[r]=u[r].get("name"),F[r]=u[r].getVisible();var n=document.createElement("li");n.innerHTML='<input type="checkbox" name="layers"><label>'+S[r]+"</label>",t.appendChild(n),F[r]&&(n.firstElementChild.checked=!0),J(n.firstElementChild,u[r])}},K=new d({url:"http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",wrapX:!1}),Z=new d({url:"http://t0.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",attributions:"\u5929\u5730\u56FE\u5C5E\u6027\u63CF\u8FF0",wrapX:!1}),$=new O,Q=new v({url:"http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achncityxy&maxFeatures=1500&outputFormat=application%2Fjson",format:new g,projection:"EPSG:4326"}),U=new v({url:"http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achinaprovince&maxFeatures=15000&outputFormat=application%2Fjson",format:new g,projection:"EPSG:4326"}),f={tiandiVec:K,tiandiMark:Z,OSM:$,city:Q,province:U},ee=function(e){for(var t in f)if(t==e){var r=new m({title:e,name:e,source:f[e]});l.addLayer(r);break}},k=function(e){for(var t in f)if(t==e){var r=new h({title:e,name:e,source:f[e]});l.addLayer(r);break}},L=function(e,t){for(var r=e.getSource(),n=r.getFeatures(),a=String(t).split(),o=".*",c=0;c<a.length;c++)o=o+(a[c]+".*");for(var E=new RegExp(o),s=0;s<n.length;s++){var G=String(n[s].get("name")).trim();if(G.match(E))return n[s]}return null},P=function(e){for(var t=l.getLayers(),r=0;r<t.getArray().length;r++){var n=t.item(r);if(n.get("name")==e)return n}return null},te=l.getView(),re=function(e){te.animate({center:e.getGeometry().getCoordinates(),duration:2e3,zoom:10})},ae=new p({image:new X({radius:10,fill:new b({color:"#dc143c"})})}),ne=new p({stroke:new q({color:"#dc143c",width:1.25}),fill:new b({color:"rgba(0.5,0.5,0.5,0.1)"}),zIndex:999}),oe=function(e){e.setStyle(ae)},ie=function(e){e.setStyle(ne)},y,C=v({wrapX:!1});h({source:C,style:new p({fill:new ol.style.Fill({color:"rgba(255,255,255,0.2)"}),stroke:new ol.style.Stroke({color:"#ff0000",width:2}),image:new ol.style.Circle({radius:7,fill:new ol.style.Fill({color:"#ff0000"})})})});var le=function(e,t){return t||(t=new ol.geom.Point(e)),t.setCoordinates(e),t},ce=function(){y=z({source:C,type:"Point",geometryFunction:le}),l.addInteraction(y)},se=function(){l.removeInteraction(y)};ee("OSM");k("city");k("province");W();_();B();Y();i(".pic-nav").on("mouseenter",function(e){i(this).hide(),i(".nav").show().stop().animate({left:0})});i(".nav").on("mouseleave",function(e){i(this).stop().animate({left:-.8*i(this).width()},function(){i(".nav").hide(),i(".pic-nav").show()})});i(".searchBar button").on("click",function(){var e=i(this).siblings("input").val();console.log(e);var t=P("city"),r=L(t,e);r!=null?(i(".searchState").text("\u5DF2\u641C\u7D22\u5230"+e+", \u4F4D\u7F6E\u5728:"+r.getGeometry().getCoordinates()),oe(r),re(r)):i(".searchState").text("\u672A\u641C\u7D22\u5230"+e+", \u8BF7\u5C1D\u8BD5\u5176\u4ED6\u4F4D\u7F6E\u3002")});i(".info-bar button").on("click",function(){var e=new XMLHttpRequest;e.open("GET","/project/GetDensePointProvince");var t=null;e.onreadystatechange=function(){if(e.readyState==4&&e.status==200){t=JSON.parse(e.response);var r=P("province");if(t==null){console.log("NetWork Error!");return}else{for(var n="",a=0;a<3;a++){var o=L(r,t[a].name);ie(o),n+=t[a].name+","+t[a].points,n+=";",console.log(n)}n=n.slice(0,n.length-1),console.log(n),i(".info-bar .info").text("\u5BC6\u5EA6\u6700\u9AD8\u7684\u4E09\u4E2A\u7701\u4EFD\u4E3A: "+n)}}},e.send()});i(".create-point").on("click",function(){ce()});i(".quit-create").on("click",function(){se()});
//# sourceMappingURL=index.624d5b1d.js.map
