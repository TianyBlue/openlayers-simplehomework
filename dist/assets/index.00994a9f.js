import{T as L,X as S,V as q,s as T,M as A,a as R,c as z,F as D,O as J,b as d,G as b,d as C,S as u,C as p,e as c,f as m,D as H,$ as e,P as W,g as Y,h as B,i as K}from"./vendor.d1bde9bf.js";const Z=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(a){if(a.ep)return;a.ep=!0;const i=n(a);fetch(a.href,i)}};Z();new L({title:"\u5929\u5730\u56FE\u77E2\u91CF",source:new S({url:"http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",wrapX:!1})});var $=new q({center:[114.5,30.5],zoom:8,projection:"EPSG:4326"});new T({units:"metric",bar:!0,text:!0,className:"ol-scale-line"});var l=new A({target:"map",layers:[],view:$}),Q=new T({units:"metric",target:"scalebar",className:"ol-scale-line"}),U=new R({className:"mosuePosition",coordinateFormat:z(5),projection:"EPSG:4326",target:document.getElementById("position")}),ee=new D,te=function(){l.addControl(Q)},ne=function(){l.addControl(ee)},oe=function(){l.addControl(U)},g=[],G=[],_=[],re=".layers";function ae(t,o){t.addEventListener("click",function(){this.checked?o.setVisible(!0):o.setVisible(!1)})}var ie=function(){for(var t=l.getLayers(),o=document.querySelector(re),n=0;n<t.getArray().length;n++){g[n]=t.item(n),G[n]=g[n].get("name"),_[n]=g[n].getVisible();var r=document.createElement("li");r.innerHTML='<input type="checkbox" name="layers"><label>'+G[n]+"</label>",o.appendChild(r),_[n]&&(r.firstElementChild.checked=!0),ae(r.firstElementChild,g[n])}},le=new S({url:"http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",wrapX:!1}),se=new S({url:"http://t0.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",attributions:"\u5929\u5730\u56FE\u5C5E\u6027\u63CF\u8FF0",wrapX:!1}),ce=new J,fe=new d({url:"http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achncityxy&maxFeatures=1500&outputFormat=application%2Fjson",format:new b,projection:"EPSG:4326"}),ue=new d({url:"http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achinaprovince&maxFeatures=15000&outputFormat=application%2Fjson",format:new b,projection:"EPSG:4326"}),de=new d({url:"http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Afoottrack&maxFeatures=1500&outputFormat=application%2Fjson",format:new b,projection:"EPSG:4326"}),h={tiandiVec:le,tiandiMark:se,OSM:ce,city:fe,province:ue,footTrack:de},pe=function(t){for(var o in h)if(o==t){var n=new L({title:t,name:t,source:h[t]});l.addLayer(n);break}},x=function(t){for(var o in h)if(o==t){var n=new C({title:t,name:t,source:h[t]});return l.addLayer(n),n}},E=function(t,o){for(var n=t.getSource(),r=n.getFeatures(),a=String(o).split(),i=".*",s=0;s<a.length;s++)i=i+(a[s]+".*");for(var X=new RegExp(i),y=0;y<r.length;y++){var I=String(r[y].get("cityname")).trim();if(I.match(X))return r[y]}return null},k=function(t){for(var o=l.getLayers(),n=0;n<o.getArray().length;n++){var r=o.item(n);if(r.get("name")==t)return r}return null},ve=l.getView(),ye=function(t){ve.animate({center:t.getGeometry().getCoordinates(),duration:2e3,zoom:10})};let me=new u({image:new p({radius:6,fill:new c({color:"#dc143c"})})}),ge=new u({stroke:new m({color:"#dc143c",width:1.25}),fill:new c({color:"rgba(0.5,0.5,0.5,0.1)"}),zIndex:999});var he=function(t){t.setStyle(me)},we=function(t){t.setStyle(ge)},F,v=new d({wrapX:!1}),N=new C({source:v,style:new u({fill:new c({color:"rgba(255,255,255,0.2)"}),stroke:new m({color:"#ff0000",width:2}),image:new p({radius:7,fill:new c({color:"#ff0000"})})}),zIndex:999,name:"\u65B0\u5EFA\u8981\u7D20\u56FE\u5C42"}),Se=function(t,o){return o||(o=new W(t)),o.setCoordinates(t),o};l.addLayer(N);var be=function(){F=new H({type:"Point",source:v,geometryFunction:Se}),l.addInteraction(F)},xe=function(){var t=v.getFeatures();if(confirm("\u662F\u5426\u4FDD\u5B58\u5DF2\u7ED8\u5236\u8981\u7D20\uFF1F")){for(var o=[],n=0;n<t.length;n++){var r=t[n];o.push(r.getGeometry().getCoordinates())}var a={pointsCount:o.length,points:o},i=JSON.stringify(a);ke(i)}else v=new d({wrapX:!1}),N.setSource(v);l.removeInteraction(F)};function ke(t){console.log(t),e.ajax({url:"/project/AddPointsToDB",type:"POST",contentType:"application/json;charset=utf-8",data:t,success:function(){alert("\u5DF2\u4FDD\u5B58")},error:function(){alert("\u4FDD\u5B58\u5931\u8D25")}})}function f(t){return t==0?"\u6682\u65E0\u6570\u636E":t}let Fe={name:"\u6682\u65E0\u6570\u636E",gdp:"\u6682\u65E0\u6570\u636E",pop:"\u6682\u65E0\u6570\u636E",ave_gdp:"\u6682\u65E0\u6570\u636E",increase_ratio:"\u6682\u65E0\u6570\u636E",construction_land:"\u6682\u65E0\u6570\u636E",inhabitant_land:"\u6682\u65E0\u6570\u636E",con_land_per:"\u6682\u65E0\u6570\u636E"};var Pe=function(t){let o=new XMLHttpRequest;o.open("GET","/project/GetStatInfo?name="+t);let n=null;o.onreadystatechange=function(){o.readyState==4&&o.status==200&&(n=JSON.parse(o.responseText),n==null&&(n=Fe),e(".info-content .name span").text(n.name),e(".info-content .gdp span").text(f(n.gdp)),e(".info-content .pop span").text(f(n.pop)),e(".info-content .ave_gdp span").text(f(n.ave_gdp)),e(".info-content .increase_ratio span").text(f(n.increase_ratio)),e(".info-content .construction_land span").text(f(n.construction_land)),e(".info-content .inhabitant_land span").text(f(n.inhabitant_land)),e(".info-content .con_land_per span").text(f(n.con_land_per)))},o.send();let r=new XMLHttpRequest;r.open("GET","/project/GetNearestCity?name="+t);let a=null;r.onreadystatechange=function(){if(r.readyState==4&&r.status==200)if(a=JSON.parse(r.responseText),a==null){console.log("NetWork Error");return}else e(".info-content .nearest_city span").text(a.name),e(".info-content .distance span").text(a.distance.toFixed(2))},r.send()};let w;l.on("pointermove",function(t){var o=l.getEventPixel(t.originalEvent);let n=!1;l.forEachFeatureAtPixel(o,(r,a)=>{a&&a.get("name")=="city"&&(n=!0)}),l.hasFeatureAtPixel(o)&&n?e("body").css("cursor","pointer"):e("body").css("cursor","default")});var Le=()=>{let t=k("city");w=new Y({condition:B,layers:[t],style:function(o){var n=new u({image:new p({radius:8,fill:new c({color:"#dc143c"})}),text:new K({font:"13px MicroSoft YaHei bolder",text:o.get("name"),fill:new c({color:"#dc143c"}),offsetX:15,offsetY:15})});return n}}),w.on("select",function(o){let n=w.getFeatures().getArray();if(n.length>0){var r=n[0];Pe(r.get("name"))}}),l.addInteraction(w)};let Te=new u({image:new p({radius:4,stroke:new m({color:"#e2d849",width:1}),fill:new c({color:"#8cc269"})})});const M=new c({color:"rgba(255,255,255,0.0)"}),O=new m({color:"#3399CC",width:1});let Ce=new u({image:new p({fill:M,stroke:O,radius:4}),fill:M,stroke:O});var j={pointStyleGrey:Te,fillStyle:Ce};pe("OSM");x("city");const Ge=x("province"),_e=x("footTrack");_e.setStyle(j.pointStyleGrey);Ge.setStyle(j.fillStyle);Le();te();ne();oe();ie();let V,P;e(".pic-nav").on("mouseenter",function(t){e(this).hide(),e(".nav").show().stop().animate({left:0})});e(".nav").on("mouseleave",function(t){e(this).stop().animate({left:-.6*e(this).width()},function(){e(".nav").hide(),e(".pic-nav").show()})});e(".searchBar .search").on("click",function(){let t=e(this).siblings("input").val(),o=k("footTrack"),n=E(o,t),r=e(".info-bar .info").html();n!=null?(e(".info-bar .info").html(r+"\u5DF2\u641C\u7D22\u5230"+t+", \u4F4D\u7F6E\u5728:<br />"+n.getGeometry().getCoordinates()+"<br /><br />"),P!=null&&P.setStyle(V),P=n,V=n.getStyle(),he(n),ye(n)):e(".info-bar .info").html(r+"\u672A\u641C\u7D22\u5230"+t+", \u8BF7\u5C1D\u8BD5\u5176\u4ED6\u4F4D\u7F6E\u3002<br /><br />")});e(".tools .density").on("click",function(){let t=new XMLHttpRequest;t.open("GET","/project/GetDensePointProvince");let o=null;t.onreadystatechange=function(){if(t.readyState==4&&t.status==200){o=JSON.parse(t.response);let n=k("province");if(o==null){console.log("NetWork Error!");return}else{console.log(o);let r="";for(let i=0;i<3;i++){let s=E(n,o[i].name);console.log(s),s&&we(s),r+=o[i].name+","+o[i].points,r+=";"}r=r.slice(0,r.length-1);let a=e(".info-bar .info").html();e(".info-bar .info").html(a+"\u5BC6\u5EA6\u6700\u9AD8\u7684\u4E09\u4E2A\u7701\u4EFD\u4E3A: "+r+"<br /><br />")}}},t.send()});e(".tools .create-point").on("click",function(){be()});e(".tools .quit-create").on("click",function(){xe()});e("a.group-page").on("click",()=>{e(".main-map").hide(),e(".courses-info").hide(),e(".group-info").show(),e(".contact-info").hide(),e(".tools-used-info").hide()});e("a.map-page").on("click",()=>{e(".main-map").show(),e(".courses-info").hide(),e(".group-info").hide(),e(".contact-info").hide(),e(".tools-used-info").hide()});e("a.courses-page").on("click",()=>{e(".main-map").hide(),e(".courses-info").show(),e(".group-info").hide(),e(".contact-info").hide(),e(".tools-used-info").hide()});e("a.contact-page").on("click",()=>{e(".main-map").hide(),e(".courses-info").hide(),e(".group-info").hide(),e(".contact-info").show(),e(".tools-used-info").hide()});e("a.tools-used-page").on("click",()=>{e(".main-map").hide(),e(".courses-info").hide(),e(".group-info").hide(),e(".contact-info").hide(),e(".tools-used-info").show()});e(".tools .open-city-info").on("click",function(){e(".city-info").toggle()});
//# sourceMappingURL=index.00994a9f.js.map
