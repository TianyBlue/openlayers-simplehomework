{"version":3,"file":"index.a87c4358.js","sources":["../../vite/modulepreload-polyfill","../../src/init/initMap.js","../../controlGadgets.js","../../src/layerControl/layerControl.js","../../src/mapSource/mapSource.js","../../src/mapSource/test.js","../../searchFeature.js","../../src/mapInteraction/flyToPoint.js","../../main.js"],"sourcesContent":["const p = function polyfill() {\n    const relList = document.createElement('link').relList;\n    if (relList && relList.supports && relList.supports('modulepreload')) {\n        return;\n    }\n    for (const link of document.querySelectorAll('link[rel=\"modulepreload\"]')) {\n        processPreload(link);\n    }\n    new MutationObserver((mutations) => {\n        for (const mutation of mutations) {\n            if (mutation.type !== 'childList') {\n                continue;\n            }\n            for (const node of mutation.addedNodes) {\n                if (node.tagName === 'LINK' && node.rel === 'modulepreload')\n                    processPreload(node);\n            }\n        }\n    }).observe(document, { childList: true, subtree: true });\n    function getFetchOpts(script) {\n        const fetchOpts = {};\n        if (script.integrity)\n            fetchOpts.integrity = script.integrity;\n        if (script.referrerpolicy)\n            fetchOpts.referrerPolicy = script.referrerpolicy;\n        if (script.crossorigin === 'use-credentials')\n            fetchOpts.credentials = 'include';\n        else if (script.crossorigin === 'anonymous')\n            fetchOpts.credentials = 'omit';\n        else\n            fetchOpts.credentials = 'same-origin';\n        return fetchOpts;\n    }\n    function processPreload(link) {\n        if (link.ep)\n            // ep marker = processed\n            return;\n        link.ep = true;\n        // prepopulate the load record\n        const fetchOpts = getFetchOpts(link);\n        fetch(link.href, fetchOpts);\n    }\n};__VITE_IS_MODERN__&&p();","import ScaleLine from 'ol/control/ScaleLine';\r\nimport { Map } from \"ol\";\r\nimport TileLayer from \"ol/layer/Tile\";\r\nimport XYZ from 'ol/source/XYZ';\r\nimport View from 'ol/View';\r\nimport { defaults } from 'ol/control';\r\nimport FullScreen from 'ol/control/FullScreen';\r\n\r\n// var cityurl = 'http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achncityxy&maxFeatures=1500&outputFormat=application%2Fjson';\r\n\r\nvar tdVec = new TileLayer({\r\n    title: \"天地图矢量\",\r\n    source: new XYZ({\r\n        url: 'http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f',\r\n        wrapX: false\r\n    })\r\n});\r\n\r\nexport var layers = [tdVec]\r\n\r\nvar normalView = new View({\r\n    center: [115, 35],\r\n    zoom: 6,\r\n    projection: 'EPSG:4326'\r\n});\r\n\r\nvar scaleBar = new ScaleLine({\r\n    units: 'metric',\r\n    // target: 'scalebar',\r\n    bar: true,\r\n    text: true,\r\n    className: 'ol-scale-line'\r\n});\r\n\r\nexport var map = new Map({\r\n    target: 'map',\r\n    layers: [\r\n        \r\n    ],\r\n    view: normalView\r\n})","import scaleLine from \"ol/control/ScaleLine\"\r\nimport { map } from \"./src/init/initMap\";\r\nimport FullScreen from 'ol/control/FullScreen';\r\nimport MousePosition from \"ol/control/MousePosition\";\r\nimport { createStringXY } from \"ol/coordinate\";\r\n\r\n\r\nvar scalecontrol = new scaleLine({\r\n    units: 'metric',\r\n    target: 'scalebar',\r\n    className: 'ol-scale-line'\r\n});\r\n\r\nvar mousePositionControl = new MousePosition({\r\n    className: 'mosuePosition',\r\n    coordinateFormat: createStringXY(6),\r\n    projection: 'EPSG:4326',\r\n    target: document.getElementById('position')\r\n});\r\n\r\nvar fullscreen = new FullScreen();\r\n\r\nexport var addScaleLine = function(){\r\n    map.addControl(scalecontrol);\r\n}\r\n\r\nexport var addFullScreen = function(){\r\n    map.addControl(fullscreen);\r\n}\r\n\r\nexport var addMousePosControl = function(){\r\n    map.addControl(mousePositionControl);\r\n}","import { map } from \"../init/initMap\";\r\n\r\nvar layer = [];\r\nvar layerName = [];\r\nvar layerVisibility = [];\r\n\r\nvar selector = '.layers';\r\n\r\n\r\nfunction clickFunction(ele, layer) {\r\n    ele.addEventListener('click', function () {\r\n        if (this.checked) {\r\n            layer.setVisible(true);\r\n        }\r\n        else {\r\n            layer.setVisible(false);\r\n        }\r\n    });\r\n}\r\n\r\nexport var initiateLayerControl = function() {\r\n    var layers = map.getLayers();\r\n    // console.log(layers);\r\n    var container = document.querySelector(selector);\r\n    for (var i = 0; i < layers.getArray().length; i++) {\r\n        layer[i] = layers.item(i);\r\n        // console.log(layer[i]);\r\n        layerName[i] = layer[i].get('name');\r\n        layerVisibility[i] = layer[i].getVisible();\r\n        var ele = document.createElement('li');\r\n        ele.innerHTML = '<input type=\"checkbox\" name=\"layers\"><label>' + layerName[i] + '</label>';\r\n        container.appendChild(ele);\r\n        if (layerVisibility[i]) {\r\n            // console.log(\"true\");\r\n            ele.firstElementChild.checked = true;\r\n        }\r\n        clickFunction(ele.firstElementChild, layer[i]);\r\n    }\r\n\r\n}","import XYZ from \"ol/source/XYZ\"\r\nimport OSM from 'ol/source/OSM';\r\nimport { Tile } from \"ol\";\r\nimport VectorSource from \"ol/source/Vector\";\r\nimport GeoJSON from \"ol/format/GeoJSON\"\r\n\r\nvar tiandi = new XYZ({\r\n    url: \"http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f\",\r\n    wrapX: false\r\n});\r\n\r\nvar tiandiMark = new XYZ({\r\n    url: \"http://t0.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f\",\r\n    attributions: \"天地图属性描述\",\r\n    wrapX: false\r\n});\r\nvar osm = new OSM();\r\n\r\nvar city = new VectorSource({\r\n    url: 'http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achncityxy&maxFeatures=1500&outputFormat=application%2Fjson',\r\n    format: new GeoJSON(),\r\n    projection: 'EPSG:4326'\r\n});\r\n\r\nexport var mapSource = {\r\n    'tiandiVec': tiandi,\r\n    'tiandiMark':tiandiMark,\r\n    'OSM': osm,\r\n    'city': city\r\n}","import { Tile } from \"ol\"\r\nimport TileLayer from \"ol/layer/Tile\"\r\nimport VectorLayer from \"ol/layer/Vector\"\r\nimport { map } from \"../init/initMap\"\r\nimport { mapSource } from \"./mapSource\"\r\n\r\nexport var addTileLayer = function(name){\r\n    for(var src in mapSource){\r\n        if(src == name){\r\n            var layer = new TileLayer({\r\n                title: name,\r\n                name:name,\r\n                source: mapSource[name],\r\n            });\r\n            map.addLayer(layer);\r\n            break;\r\n        }\r\n    }\r\n}\r\n\r\nexport var addVectorLayer = function(name){\r\n    for(var src in mapSource){\r\n        if(src == name){\r\n            var layer = new VectorLayer({\r\n                title: name,\r\n                name:name,\r\n                source: mapSource[name],\r\n            });\r\n            map.addLayer(layer);\r\n            break;\r\n        }\r\n    }\r\n}","import { map } from \"./src/init/initMap\"\r\n\r\nexport var getFeature = function(layername,attr){\r\n    var layers = map.getLayers();\r\n    for(var i=0;i<layers.getArray().length;i++){\r\n        var layer = layers.item(i);\r\n        if(layer.get('name')==layername)\r\n        {\r\n            var features = layer.getSource().getFeatures();\r\n            for(var j=0;j<features.length;j++){\r\n                var name = String(features[j].get('name'));\r\n                if(name.trim()==attr)\r\n                    return features[j];\r\n            }\r\n        }\r\n    }\r\n    return null;\r\n}\r\n","import { fromLonLat } from \"ol/proj\";\r\nimport { map } from \"../init/initMap\";\r\n\r\nvar view = map.getView();\r\n\r\nexport var flyToFeature=function(feature){\r\n\r\n    // var ext = feature.getGeometry().getExtent();\r\n\r\n    view.animate({\r\n        center: feature.getGeometry().getCoordinates(),\r\n        duration: 2000,\r\n        zoom: 10\r\n        // easing:function (t) {\r\n        //     var s = 7.5625, p = 2.75, l;\r\n        //     if (t < (1 / p)) {\r\n        //         l = s * t * t;\r\n        //     } else {\r\n        //         if (t < (2 / p)) {\r\n        //             t -= (1.5 / p);\r\n        //             l = s * t * t + 0.75;\r\n        //         } else {\r\n        //             if (t < (2.5 / p)) {\r\n        //                 t -= (2.25 / p);\r\n        //                 l = s * t * t + 0.9375;\r\n        //             } else {\r\n        //                 t -= (2.625 / p);\r\n        //                 l = s * t * t + 0.984375;\r\n        //             }\r\n        //         }\r\n        //     }\r\n        //     return l;\r\n        // }\r\n    });\r\n\r\n    // window.setTimeout(function(){\r\n    //     view.setZoom(10);\r\n    // },2000);\r\n\r\n}","import { addFullScreen, addMousePosControl, addScaleLine } from \"./controlGadgets\";\nimport { map } from \"./src/init/initMap\"\nimport { initiateLayerControl } from \"./src/layerControl/layerControl\";\nimport { addTileLayer, addVectorLayer } from \"./src/mapSource/test\"\nimport $ from \"jquery\"\nimport { getFeature } from \"./searchFeature\";\nimport { flyToFeature } from \"./src/mapInteraction/flyToPoint\";\n\naddTileLayer('OSM');\naddVectorLayer('city');\n\naddScaleLine();\naddFullScreen();\naddMousePosControl();\ninitiateLayerControl();\n\n$('.pic-nav').on('mouseenter',function(e){\n    $(this).animate({\n        left: 0\n    },function(){\n        $('.pic-nav').hide().css('left',-0.8 * $('.pic-nav').width())\n        $('.nav').show();\n    });\n});\n\n$('.nav').on('mouseleave',function(e){\n    $(this).animate({\n        left: -0.8 * $(this).width()\n    },function(){\n        $('.nav').hide().css('left',0);\n        $('.pic-nav').show();\n    })\n});\n\n$('.searchBar button').on('click',function(){\n    var attr = $(this).siblings('input').val();\n    console.log(attr);\n    var feature = getFeature('city',attr);\n    flyToFeature(feature);\n    if(feature != null)\n        $('.searchState').text = \"已搜索到\" + attr +\", 位置在:\" \n                    + feature.getGeometry().getCoordinates();\n    else\n        \"未搜索到\" + attr + \", 请尝试其他位置。\" \n});"],"names":["ScaleLine"],"mappings":"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"}