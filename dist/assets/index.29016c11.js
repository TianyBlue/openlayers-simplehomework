import{T as w,X as p,V,s as h,M as O,a as T,c as X,F as q,O as z,b as f,G as b,d as S,S as y,C as F,e as v,f as L,D,P as I,$ as i}from"./vendor.82360beb.js";const R=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function r(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerpolicy&&(o.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?o.credentials="include":n.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function a(n){if(n.ep)return;n.ep=!0;const o=r(n);fetch(n.href,o)}};R();new w({title:"\u5929\u5730\u56FE\u77E2\u91CF",source:new p({url:"http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",wrapX:!1})});var j=new V({center:[115,35],zoom:6,projection:"EPSG:4326"});new h({units:"metric",bar:!0,text:!0,className:"ol-scale-line"});var s=new O({target:"map",layers:[],view:j}),J=new h({units:"metric",target:"scalebar",className:"ol-scale-line"}),W=new T({className:"mosuePosition",coordinateFormat:X(6),projection:"EPSG:4326",target:document.getElementById("position")}),_=new q,A=function(){s.addControl(J)},B=function(){s.addControl(_)},H=function(){s.addControl(W)},d=[],k=[],P=[],Y=".layers";function K(e,t){e.addEventListener("click",function(){this.checked?t.setVisible(!0):t.setVisible(!1)})}var Z=function(){for(var e=s.getLayers(),t=document.querySelector(Y),r=0;r<e.getArray().length;r++){d[r]=e.item(r),k[r]=d[r].get("name"),P[r]=d[r].getVisible();var a=document.createElement("li");a.innerHTML='<input type="checkbox" name="layers"><label>'+k[r]+"</label>",t.appendChild(a),P[r]&&(a.firstElementChild.checked=!0),K(a.firstElementChild,d[r])}},$=new p({url:"http://t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",wrapX:!1}),Q=new p({url:"http://t0.tianditu.com/DataServer?T=cva_w&x={x}&y={y}&l={z}&tk=3bc6874f2b919aa581635abab7759a3f",attributions:"\u5929\u5730\u56FE\u5C5E\u6027\u63CF\u8FF0",wrapX:!1}),U=new z,ee=new f({url:"http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achncityxy&maxFeatures=1500&outputFormat=application%2Fjson",format:new b,projection:"EPSG:4326"}),te=new f({url:"http://localhost:31142/geoserver/dbtest/ows?service=WFS&version=1.0.0&request=GetFeature&typeName=dbtest%3Achinaprovince&maxFeatures=15000&outputFormat=application%2Fjson",format:new b,projection:"EPSG:4326"}),m={tiandiVec:$,tiandiMark:Q,OSM:U,city:ee,province:te},re=function(e){for(var t in m)if(t==e){var r=new w({title:e,name:e,source:m[e]});s.addLayer(r);break}},C=function(e){for(var t in m)if(t==e){var r=new S({title:e,name:e,source:m[e]});s.addLayer(r);break}},G=function(e,t){for(var r=e.getSource(),a=r.getFeatures(),n=String(t).split(),o=".*",c=0;c<n.length;c++)o=o+(n[c]+".*");for(var x=new RegExp(o),u=0;u<a.length;u++){var M=String(a[u].get("name")).trim();if(M.match(x))return a[u]}return null},E=function(e){for(var t=s.getLayers(),r=0;r<t.getArray().length;r++){var a=t.item(r);if(a.get("name")==e)return a}return null},ae=s.getView(),ne=function(e){ae.animate({center:e.getGeometry().getCoordinates(),duration:2e3,zoom:10})},oe=new y({image:new F({radius:10,fill:new v({color:"#dc143c"})})}),ie=new y({stroke:new L({color:"#dc143c",width:1.25}),fill:new v({color:"rgba(0.5,0.5,0.5,0.1)"}),zIndex:999}),se=function(e){e.setStyle(oe)},ce=function(e){e.setStyle(ie)},g,l=new f({wrapX:!1}),N=new S({source:l,style:new y({fill:new v({color:"rgba(255,255,255,0.2)"}),stroke:new L({color:"#ff0000",width:2}),image:new F({radius:7,fill:new v({color:"#ff0000"})})}),zIndex:999,name:"\u65B0\u5EFA\u8981\u7D20\u56FE\u5C42"}),le=function(e,t){return t||(t=new I(e)),t.setCoordinates(e),t};s.addLayer(N);var ue=function(){g=new D({type:"Point",source:l,geometryFunction:le}),s.addInteraction(g)},fe=function(){var e=l.getFeatures();if(confirm("\u662F\u5426\u4FDD\u5B58\u5DF2\u7ED8\u5236\u8981\u7D20\uFF1F")){for(var t=[],r=0;r<e.length;r++){var a=e[r],n=[a.getGeometry().getCoordinates()[0],a.getGeometry().getCoordinates()[0],450];t.push(n)}var o={pointsCount:t.length,points:t};JSON.stringify(o),console.log(t)}else l=new f({wrapX:!1}),N.setSource(l);s.removeInteraction(g)};re("OSM");C("city");C("province");A();B();H();Z();i(".pic-nav").on("mouseenter",function(e){i(this).hide(),i(".nav").show().stop().animate({left:0})});i(".nav").on("mouseleave",function(e){i(this).stop().animate({left:-.8*i(this).width()},function(){i(".nav").hide(),i(".pic-nav").show()})});i(".searchBar button").on("click",function(){var e=i(this).siblings("input").val();console.log(e);var t=E("city"),r=G(t,e);r!=null?(i(".searchState").text("\u5DF2\u641C\u7D22\u5230"+e+", \u4F4D\u7F6E\u5728:"+r.getGeometry().getCoordinates()),se(r),ne(r)):i(".searchState").text("\u672A\u641C\u7D22\u5230"+e+", \u8BF7\u5C1D\u8BD5\u5176\u4ED6\u4F4D\u7F6E\u3002")});i(".info-bar button").on("click",function(){var e=new XMLHttpRequest;e.open("GET","/project/GetDensePointProvince");var t=null;e.onreadystatechange=function(){if(e.readyState==4&&e.status==200){t=JSON.parse(e.response);var r=E("province");if(t==null){console.log("NetWork Error!");return}else{for(var a="",n=0;n<3;n++){var o=G(r,t[n].name);ce(o),a+=t[n].name+","+t[n].points,a+=";",console.log(a)}a=a.slice(0,a.length-1),console.log(a),i(".info-bar .info").text("\u5BC6\u5EA6\u6700\u9AD8\u7684\u4E09\u4E2A\u7701\u4EFD\u4E3A: "+a)}}},e.send()});i(".create-point").on("click",function(){ue()});i(".quit-create").on("click",function(){fe()});
//# sourceMappingURL=index.29016c11.js.map
